# üéÆ –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–Ω–∞—Ç –¥–ª—è –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–∞

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### Backend (WebSocket + API)

#### 1. WebSocket Server (`backend/src/socket.ts`)

- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT** - –≤—Å–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç –≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω
- **–°–æ–±—ã—Ç–∏—è**:
  - `join-room` - –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ
  - `leave-room` - –≤—ã—Ö–æ–¥ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã
  - `disconnect` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏
  - `room-players-updated` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

#### 2. API Endpoints (–ö–æ–º–Ω–∞—Ç—ã)

- `GET /api/rooms/active` - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç (–ø—É–±–ª–∏—á–Ω—ã–π)
- `GET /api/rooms` - –ü–æ–ª—É—á–∏—Ç—å –∫–æ–º–Ω–∞—Ç—ã –º–∞—Å—Ç–µ—Ä–∞ (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é)
- `POST /api/rooms` - –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤)
- `GET /api/rooms/:id` - –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–Ω–∞—Ç–µ
- `PUT /api/rooms/:id` - –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü)
- `DELETE /api/rooms/:id` - –£–¥–∞–ª–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü)
- `POST /api/rooms/:id/join` - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ (—Å –ø–∞—Ä–æ–ª–µ–º)

#### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Prisma)

```prisma
model Room {
  id         String   @id @default(uuid())
  masterId   String
  name       String
  maxPlayers Int      @default(4)
  password   String   // –•–µ—à–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ bcrypt
  isActive   Boolean  @default(true)

  master  User         @relation(...)
  players RoomPlayer[]
}

model RoomPlayer {
  id        String   @id @default(uuid())
  roomId    String
  userId    String
  joinedAt  DateTime @default(now())
  isOnline  Boolean  @default(true) // –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ WebSocket

  room Room @relation(...)
  user User @relation(...)
}
```

### Frontend (React)

#### 1. Socket Context (`src/contexts/SocketContext.tsx`)

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ localStorage
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è

#### 2. –°—Ç—Ä–∞–Ω–∏—Ü—ã

##### –î–ª—è –ú–∞—Å—Ç–µ—Ä–æ–≤:

- **MyRoomsPage** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏–º–∏ –∫–æ–º–Ω–∞—Ç–∞–º–∏
  - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–Ω–∞—Ç
  - –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è
  - –£–¥–∞–ª–µ–Ω–∏–µ
- **CreateRoomPage** - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã
  - –ù–∞–∑–≤–∞–Ω–∏–µ
  - –ú–∞–∫—Å–∏–º—É–º –∏–≥—Ä–æ–∫–æ–≤ (1-20)
  - –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞)
- **RoomDetailsPage** - –î–µ—Ç–∞–ª–∏ –∫–æ–º–Ω–∞—Ç—ã
  - **–°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** —á–µ—Ä–µ–∑ WebSocket
  - –û–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞
  - –°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
  - ID –∫–æ–º–Ω–∞—Ç—ã

##### –î–ª—è –ò–≥—Ä–æ–∫–æ–≤:

- **BrowseRoomsPage** - –ü–æ–∏—Å–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç
  - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç
  - –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/–º–∞—Å—Ç–µ—Ä—É
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–Ω–∞—Ç–µ (–º–∞—Å—Ç–µ—Ä, –º–∞–∫—Å. –∏–≥—Ä–æ–∫–æ–≤)
- **JoinRoomPage** - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ
  - –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ú–∞—Å—Ç–µ—Ä —Å–æ–∑–¥–∞—ë—Ç –∫–æ–º–Ω–∞—Ç—É

```
–ú–∞—Å—Ç–µ—Ä ‚Üí CreateRoomPage ‚Üí POST /api/rooms
                        ‚Üí –ö–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ –ë–î
                        ‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ MyRoomsPage
```

### 2. –ò–≥—Ä–æ–∫ –Ω–∞—Ö–æ–¥–∏—Ç –∫–æ–º–Ω–∞—Ç—É

```
–ò–≥—Ä–æ–∫ ‚Üí BrowseRoomsPage ‚Üí GET /api/rooms/active
                        ‚Üí –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç
                        ‚Üí –ö–ª–∏–∫ "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è"
```

### 3. –ò–≥—Ä–æ–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è

```
–ò–≥—Ä–æ–∫ ‚Üí JoinRoomPage ‚Üí –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è
                     ‚Üí POST /api/rooms/:id/join
                     ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è (bcrypt)
                     ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ RoomPlayer
                     ‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ RoomDetailsPage
```

### 4. WebSocket –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```
–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ RoomDetailsPage:
1. socket.emit('join-room', roomId)
   ‚Üí –°–µ—Ä–≤–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–∫–µ—Ç –≤ –∫–æ–º–Ω–∞—Ç—É
   ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç isOnline = true

2. –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º:
   socket.to('room:${roomId}').emit('room-players-updated', players)

3. –ö–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
   ‚Üí –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏:
- socket.emit('leave-room', roomId)
- isOnline = false
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
```

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫

```bash
# Terminal 1: Frontend
npm run dev

# Terminal 2: Backend
cd backend
npm run dev
```

### –î–æ—Å—Ç—É–ø

- Frontend: http://localhost:5173
- Backend API: http://localhost:3001/api
- WebSocket: ws://localhost:3001

## üîë –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏—á–∏

‚úÖ **–ó–∞—â–∏—Ç–∞ –ø–∞—Ä–æ–ª–µ–º** - bcrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚úÖ **–û–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å** - –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ WebSocket
‚úÖ **–†–æ–ª–∏** - –ú–∞—Å—Ç–µ—Ä vs –ò–≥—Ä–æ–∫
‚úÖ **–õ–∏–º–∏—Ç –∏–≥—Ä–æ–∫–æ–≤** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π (1-20)
‚úÖ **–ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è** - —Å–∫—Ä—ã—Ç–∏–µ –∫–æ–º–Ω–∞—Ç
‚úÖ **–ü–æ–∏—Å–∫ –∫–æ–º–Ω–∞—Ç** - –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ –º–∞—Å—Ç–µ—Ä—É
‚úÖ **–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è** - —Å—Å—ã–ª–∫–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—Ö–æ–¥–∞
‚úÖ **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –¥–ª—è WebSocket –∏ API

## üìù TODO (–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è)

- [ ] –ß–∞—Ç –≤ –∫–æ–º–Ω–∞—Ç–µ
- [ ] –ü–µ—Ä–µ–¥–∞—á–∞ –ª–∏—Å—Ç–æ–≤ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –º–∞—Å—Ç–µ—Ä—É
- [ ] –ë—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–æ–≤ —Å –æ–±—â–∏–º –ª–æ–≥–æ–º
- [ ] –ö–∞—Ä—Ç—ã –∏ —Ç–æ–∫–µ–Ω—ã
- [ ] –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –í–∏–¥–µ–æ/–∞—É–¥–∏–æ —á–∞—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –ù–µ—Ç - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç! ‚ú®

## üìö –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Backend**: Express + Socket.IO + Prisma + JWT
- **Frontend**: React + Socket.IO Client + React Router
- **Database**: PostgreSQL (Neon)
- **Real-time**: WebSocket (Socket.IO)
