// PHB 2024 Glossary - Глоссарий терминов

export interface GlossaryEntry {
  id: string;
  name: string;
  nameRu: string;
  category: "weapon_property" | "armor_property" | "condition" | "action" | "term";
  description: string;
}

// ======================= СВОЙСТВА ОРУЖИЯ =======================
export const weaponProperties: GlossaryEntry[] = [
  {
    id: "ammunition",
    name: "Ammunition",
    nameRu: "Боеприпас",
    category: "weapon_property",
    description:
      "Вы можете использовать это оружие для дальнобойной атаки, только если у вас есть боеприпасы. Каждая атака расходует один боеприпас. Доставание боеприпасов из колчана или другого контейнера — часть атаки. В конце боя вы можете потратить 1 минуту, чтобы найти половину использованных боеприпасов (округляя вниз).",
  },
  {
    id: "finesse",
    name: "Finesse",
    nameRu: "Фехтовальное",
    category: "weapon_property",
    description:
      "При совершении атаки этим оружием вы можете использовать на свой выбор модификатор Силы или Ловкости для бросков атаки и урона. Для обоих бросков должен использоваться один и тот же модификатор.",
  },
  {
    id: "heavy",
    name: "Heavy",
    nameRu: "Тяжёлое",
    category: "weapon_property",
    description:
      "Существа Маленького размера совершают броски атаки с помехой этим оружием. Размер и громоздкость оружия делают его слишком большим для эффективного использования маленькими существами.",
  },
  {
    id: "light",
    name: "Light",
    nameRu: "Лёгкое",
    category: "weapon_property",
    description:
      "Это оружие маленькое и удобное для рукопашного боя. Когда вы совершаете действие Атака и атакуете лёгким оружием в одной руке, вы можете использовать бонусное действие для атаки другим лёгким оружием в другой руке. Вы не добавляете модификатор характеристики к урону бонусной атаки, если только этот модификатор не отрицательный.",
  },
  {
    id: "loading",
    name: "Loading",
    nameRu: "Перезарядка",
    category: "weapon_property",
    description:
      "Из-за времени, требуемого для зарядки этого оружия, вы можете выстрелить из него только один раз, когда совершаете действие, бонусное действие или реакцию, независимо от количества ваших атак.",
  },
  {
    id: "range",
    name: "Range",
    nameRu: "Дистанция",
    category: "weapon_property",
    description:
      "Оружие с этим свойством можно использовать для дальнобойных атак. Дистанция указывается в скобках после свойства — первое число — нормальная дистанция в футах, второе — максимальная. Атаки за пределами нормальной дистанции совершаются с помехой. Вы не можете атаковать цели за пределами максимальной дистанции.",
  },
  {
    id: "reach",
    name: "Reach",
    nameRu: "Досягаемость",
    category: "weapon_property",
    description:
      "Это оружие добавляет 5 футов к вашей досягаемости при атаке, а также при определении досягаемости для провоцированных атак.",
  },
  {
    id: "thrown",
    name: "Thrown",
    nameRu: "Метательное",
    category: "weapon_property",
    description:
      "Вы можете метать это оружие для совершения дальнобойной атаки. Если оружие рукопашное, вы используете для бросков атаки и урона тот же модификатор характеристики, который использовали бы для рукопашной атаки этим оружием.",
  },
  {
    id: "two-handed",
    name: "Two-Handed",
    nameRu: "Двуручное",
    category: "weapon_property",
    description: "Для атаки этим оружием нужно держать его двумя руками.",
  },
  {
    id: "versatile",
    name: "Versatile",
    nameRu: "Универсальное",
    category: "weapon_property",
    description:
      "Этим оружием можно пользоваться одной или двумя руками. В скобках после свойства указан урон при использовании двумя руками.",
  },
  {
    id: "special",
    name: "Special",
    nameRu: "Особое",
    category: "weapon_property",
    description:
      "Это оружие имеет особые правила, описанные в его описании. Например, рыцарское копьё наносит помеху при атаке целей в пределах 5 футов. Сеть не наносит урона, но опутывает Большое или меньшее существо.",
  },
];

// ======================= СВОЙСТВА ДОСПЕХОВ =======================
export const armorProperties: GlossaryEntry[] = [
  {
    id: "stealth-disadvantage",
    name: "Stealth Disadvantage",
    nameRu: "Помеха скрытности",
    category: "armor_property",
    description:
      "Ношение этого доспеха даёт помеху на проверки Ловкости (Скрытность).",
  },
  {
    id: "strength-requirement",
    name: "Strength Requirement",
    nameRu: "Требование Силы",
    category: "armor_property",
    description:
      "Если ваша Сила ниже указанного значения, ваша скорость уменьшается на 10 футов при ношении этого доспеха.",
  },
  {
    id: "don-doff",
    name: "Don/Doff",
    nameRu: "Надевание/Снятие",
    category: "armor_property",
    description:
      "Лёгкий доспех: 1 минута надеть / 1 минута снять. Средний доспех: 5 минут надеть / 1 минута снять. Тяжёлый доспех: 10 минут надеть / 5 минут снять. Щит: 1 действие надеть или снять.",
  },
];

// ======================= СОСТОЯНИЯ =======================
export const conditions: GlossaryEntry[] = [
  {
    id: "blinded",
    name: "Blinded",
    nameRu: "Ослеплённый",
    category: "condition",
    description:
      "• Существо автоматически проваливает проверки, требующие зрения.\n• Броски атаки против существа совершаются с преимуществом, а броски атаки существа — с помехой.",
  },
  {
    id: "charmed",
    name: "Charmed",
    nameRu: "Очарованный",
    category: "condition",
    description:
      "• Существо не может атаковать того, кто его очаровал, или выбирать его целью вредоносных способностей и магических эффектов.\n• Очаровавший совершает с преимуществом все проверки при социальном взаимодействии с существом.",
  },
  {
    id: "deafened",
    name: "Deafened",
    nameRu: "Оглохший",
    category: "condition",
    description:
      "• Существо автоматически проваливает проверки, требующие слуха.",
  },
  {
    id: "exhaustion",
    name: "Exhaustion",
    nameRu: "Истощение",
    category: "condition",
    description:
      "Истощение измеряется шестью уровнями:\n1 — Помеха на проверки характеристик\n2 — Скорость уменьшена вдвое\n3 — Помеха на броски атаки и спасброски\n4 — Максимум хитов уменьшен вдвое\n5 — Скорость 0\n6 — Смерть\nКаждый длинный отдых снимает один уровень.",
  },
  {
    id: "frightened",
    name: "Frightened",
    nameRu: "Испуганный",
    category: "condition",
    description:
      "• Существо совершает с помехой проверки характеристик и броски атаки, пока видит источник страха.\n• Существо не может добровольно приблизиться к источнику страха.",
  },
  {
    id: "grappled",
    name: "Grappled",
    nameRu: "Схваченный",
    category: "condition",
    description:
      "• Скорость существа становится 0, и оно не получает преимуществ от бонусов к скорости.\n• Состояние заканчивается, если схвативший становится недееспособным или если эффект выводит существо из досягаемости.",
  },
  {
    id: "incapacitated",
    name: "Incapacitated",
    nameRu: "Недееспособный",
    category: "condition",
    description:
      "• Существо не может совершать действия, бонусные действия или реакции.",
  },
  {
    id: "invisible",
    name: "Invisible",
    nameRu: "Невидимый",
    category: "condition",
    description:
      "• Существо невозможно увидеть без магии или особого чувства. Считается сильно заслонённым.\n• Местоположение можно определить по шуму или следам.\n• Броски атаки против существа совершаются с помехой, а броски атаки существа — с преимуществом.",
  },
  {
    id: "paralyzed",
    name: "Paralyzed",
    nameRu: "Парализованный",
    category: "condition",
    description:
      "• Существо недееспособно и не может двигаться или говорить.\n• Автоматически проваливает спасброски Силы и Ловкости.\n• Броски атаки против существа совершаются с преимуществом.\n• Попадание в пределах 5 футов — критический удар.",
  },
  {
    id: "petrified",
    name: "Petrified",
    nameRu: "Окаменевший",
    category: "condition",
    description:
      "• Существо и всё несомое превращается в камень. Вес увеличивается в 10 раз, существо не стареет.\n• Недееспособно, не может двигаться или говорить, не осознаёт окружение.\n• Броски атаки против существа совершаются с преимуществом.\n• Автоматически проваливает спасброски Силы и Ловкости.\n• Сопротивление всем типам урона. Иммунитет к яду и болезням.",
  },
  {
    id: "poisoned",
    name: "Poisoned",
    nameRu: "Отравленный",
    category: "condition",
    description:
      "• Существо совершает с помехой броски атаки и проверки характеристик.",
  },
  {
    id: "prone",
    name: "Prone",
    nameRu: "Лежащий ничком",
    category: "condition",
    description:
      "• Может только ползти или потратить половину скорости, чтобы встать.\n• Совершает с помехой броски атаки.\n• Броски атаки с дистанции 5 футов против существа совершаются с преимуществом, иначе — с помехой.",
  },
  {
    id: "restrained",
    name: "Restrained",
    nameRu: "Опутанный",
    category: "condition",
    description:
      "• Скорость существа становится 0, и оно не получает преимуществ от бонусов к скорости.\n• Броски атаки против существа совершаются с преимуществом, а броски атаки существа — с помехой.\n• Существо совершает с помехой спасброски Ловкости.",
  },
  {
    id: "stunned",
    name: "Stunned",
    nameRu: "Ошеломлённый",
    category: "condition",
    description:
      "• Существо недееспособно, не может двигаться и может говорить только запинаясь.\n• Автоматически проваливает спасброски Силы и Ловкости.\n• Броски атаки против существа совершаются с преимуществом.",
  },
  {
    id: "unconscious",
    name: "Unconscious",
    nameRu: "Бессознательный",
    category: "condition",
    description:
      "• Существо недееспособно, не может двигаться или говорить, не осознаёт окружение.\n• Роняет всё держимое и падает ничком.\n• Автоматически проваливает спасброски Силы и Ловкости.\n• Броски атаки против существа совершаются с преимуществом.\n• Попадание в пределах 5 футов — критический удар.",
  },
];

// ======================= ДЕЙСТВИЯ В БОЮ =======================
export const combatActions: GlossaryEntry[] = [
  {
    id: "attack",
    name: "Attack",
    nameRu: "Атака",
    category: "action",
    description:
      "Вы совершаете одну рукопашную или дальнобойную атаку. Некоторые особенности позволяют совершать несколько атак этим действием.",
  },
  {
    id: "cast-spell",
    name: "Cast a Spell",
    nameRu: "Накладывание заклинания",
    category: "action",
    description:
      "Вы накладываете заклинание со временем накладывания 1 действие. Смотрите описание заклинания для деталей.",
  },
  {
    id: "dash",
    name: "Dash",
    nameRu: "Рывок",
    category: "action",
    description:
      "Вы получаете дополнительное перемещение на этот ход, равное вашей скорости (после применения модификаторов).",
  },
  {
    id: "disengage",
    name: "Disengage",
    nameRu: "Отход",
    category: "action",
    description:
      "Ваше перемещение не провоцирует провоцированных атак до конца хода.",
  },
  {
    id: "dodge",
    name: "Dodge",
    nameRu: "Уклонение",
    category: "action",
    description:
      "До начала вашего следующего хода броски атаки против вас совершаются с помехой (если вы видите атакующего), и вы совершаете спасброски Ловкости с преимуществом. Вы теряете эту выгоду, если становитесь недееспособным или ваша скорость падает до 0.",
  },
  {
    id: "help",
    name: "Help",
    nameRu: "Помощь",
    category: "action",
    description:
      "Вы помогаете другому существу в задаче. Оно получает преимущество на следующую проверку характеристики для этой задачи. Или вы помогаете союзнику в пределах 5 футов атаковать существо — союзник получает преимущество на первую атаку по этому существу до вашего следующего хода.",
  },
  {
    id: "hide",
    name: "Hide",
    nameRu: "Засада",
    category: "action",
    description:
      "Вы совершаете проверку Ловкости (Скрытность), пытаясь спрятаться. При успехе вы получаете определённые преимущества (смотрите «Невидимые атакующие и цели»).",
  },
  {
    id: "ready",
    name: "Ready",
    nameRu: "Подготовка",
    category: "action",
    description:
      "Вы готовите действие для использования позже. Опишите обстоятельства, которые вызовут реакцию, и действие, которое совершите. Когда триггер срабатывает, вы можете использовать реакцию для совершения действия или проигнорировать триггер.",
  },
  {
    id: "search",
    name: "Search",
    nameRu: "Поиск",
    category: "action",
    description:
      "Вы совершаете проверку Мудрости (Внимательность) или Интеллекта (Расследование), в зависимости от того, что ищете.",
  },
  {
    id: "use-object",
    name: "Use an Object",
    nameRu: "Использование предмета",
    category: "action",
    description:
      "Вы взаимодействуете с предметом, требующим действия. Также используется для второго взаимодействия с предметом в ход.",
  },
  {
    id: "grapple",
    name: "Grapple",
    nameRu: "Захват",
    category: "action",
    description:
      "Когда вы хотите схватить существо, вы можете использовать действие Атака для специальной рукопашной атаки — захвата. Цель должна быть не более чем на один размер больше вас. Совершите проверку Силы (Атлетика), оспариваемую проверкой Силы (Атлетика) или Ловкости (Акробатика) цели. При успехе цель получает состояние Схваченный.",
  },
  {
    id: "shove",
    name: "Shove",
    nameRu: "Толчок",
    category: "action",
    description:
      "Вы можете использовать действие Атака для толчка существа. Цель должна быть не более чем на один размер больше вас. Совершите проверку Силы (Атлетика), оспариваемую проверкой Силы (Атлетика) или Ловкости (Акробатика) цели. При успехе вы либо сбиваете цель с ног, либо отталкиваете на 5 футов.",
  },
];

// ======================= ОБЩИЕ ТЕРМИНЫ =======================
export const generalTerms: GlossaryEntry[] = [
  {
    id: "advantage",
    name: "Advantage",
    nameRu: "Преимущество",
    category: "term",
    description:
      "Бросьте два d20 и используйте больший результат. Если у вас одновременно преимущество и помеха, они отменяются (бросается один d20).",
  },
  {
    id: "disadvantage",
    name: "Disadvantage",
    nameRu: "Помеха",
    category: "term",
    description:
      "Бросьте два d20 и используйте меньший результат. Если у вас одновременно преимущество и помеха, они отменяются (бросается один d20).",
  },
  {
    id: "proficiency-bonus",
    name: "Proficiency Bonus",
    nameRu: "Бонус мастерства",
    category: "term",
    description:
      "Бонус, добавляемый к броскам, которыми вы владеете. Зависит от уровня:\n1-4 уровень: +2\n5-8 уровень: +3\n9-12 уровень: +4\n13-16 уровень: +5\n17-20 уровень: +6",
  },
  {
    id: "hit-points",
    name: "Hit Points",
    nameRu: "Хиты",
    category: "term",
    description:
      "Представляют комбинацию физической и ментальной выносливости, воли к жизни и удачи. Когда хиты падают до 0, вы без сознания и делаете спасброски от смерти.",
  },
  {
    id: "armor-class",
    name: "Armor Class",
    nameRu: "Класс Доспехов (КД)",
    category: "term",
    description:
      "Представляет, насколько сложно вас поразить. Бросок атаки должен быть равен или превышать ваш КД, чтобы попасть.\nБез доспехов: 10 + модификатор Ловкости\nЛёгкий доспех: КД доспеха + модификатор Ловкости\nСредний доспех: КД доспеха + модификатор Ловкости (макс. +2)\nТяжёлый доспех: КД доспеха",
  },
  {
    id: "saving-throw",
    name: "Saving Throw",
    nameRu: "Спасбросок",
    category: "term",
    description:
      "Бросок для сопротивления заклинанию, ловушке, яду, болезни или подобной угрозе. Бросьте d20 + модификатор характеристики + бонус мастерства (если владеете).",
  },
  {
    id: "ability-check",
    name: "Ability Check",
    nameRu: "Проверка характеристики",
    category: "term",
    description:
      "Бросок для проверки врождённого таланта и тренировки при попытке преодолеть испытание. Бросьте d20 + модификатор характеристики + бонус мастерства (если владеете навыком).",
  },
  {
    id: "concentration",
    name: "Concentration",
    nameRu: "Концентрация",
    category: "term",
    description:
      "Некоторые заклинания требуют концентрации для поддержания магии. Вы теряете концентрацию, если:\n• Накладываете другое заклинание с концентрацией\n• Получаете урон и проваливаете спасбросок Телосложения (Сл = 10 или половина урона, что больше)\n• Становитесь недееспособным или умираете\n• Полностью отвлекаетесь (на усмотрение Мастера)",
  },
  {
    id: "spell-attack",
    name: "Spell Attack",
    nameRu: "Атака заклинанием",
    category: "term",
    description:
      "Многие заклинания требуют броска атаки. Бонус атаки = модификатор базовой характеристики заклинаний + бонус мастерства.",
  },
  {
    id: "spell-save-dc",
    name: "Spell Save DC",
    nameRu: "Сложность спасброска заклинаний",
    category: "term",
    description:
      "Сложность спасброска = 8 + модификатор базовой характеристики заклинаний + бонус мастерства.",
  },
  {
    id: "heroic-inspiration",
    name: "Heroic Inspiration",
    nameRu: "Героическое вдохновение",
    category: "term",
    description:
      "Даётся Мастером за отыгрыш или некоторыми способностями. Вы можете потратить его, чтобы бросить d20 с преимуществом. Вы можете иметь только одно Вдохновение одновременно.",
  },
  {
    id: "temporary-hp",
    name: "Temporary Hit Points",
    nameRu: "Временные хиты",
    category: "term",
    description:
      "Буфер против урона. Не суммируются — выберите лучшее значение. Не могут восстановить хиты и не считаются хитами. Исчезают после длинного отдыха.",
  },
  {
    id: "long-rest",
    name: "Long Rest",
    nameRu: "Длинный отдых",
    category: "term",
    description:
      "Период отдыха минимум 8 часов (6 часов сна + 2 часа лёгкой активности). Восстанавливает все хиты, половину Костей Хитов, все ячейки заклинаний и большинство способностей. Можно получить пользу только раз за 24 часа.",
  },
  {
    id: "short-rest",
    name: "Short Rest",
    nameRu: "Короткий отдых",
    category: "term",
    description:
      "Период отдыха минимум 1 час. Можно потратить Кости Хитов для восстановления хитов. Некоторые способности восстанавливаются после короткого отдыха.",
  },
];

// Все записи глоссария
export const allGlossaryEntries: GlossaryEntry[] = [
  ...weaponProperties,
  ...armorProperties,
  ...conditions,
  ...combatActions,
  ...generalTerms,
];

// Функции поиска
export function getGlossaryEntry(id: string): GlossaryEntry | undefined {
  return allGlossaryEntries.find((entry) => entry.id === id);
}

export function getGlossaryByCategory(category: GlossaryEntry["category"]): GlossaryEntry[] {
  return allGlossaryEntries.filter((entry) => entry.category === category);
}

export function searchGlossary(query: string): GlossaryEntry[] {
  const lowerQuery = query.toLowerCase();
  return allGlossaryEntries.filter(
    (entry) =>
      entry.name.toLowerCase().includes(lowerQuery) ||
      entry.nameRu.toLowerCase().includes(lowerQuery) ||
      entry.description.toLowerCase().includes(lowerQuery)
  );
}
